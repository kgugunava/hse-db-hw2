# Отчет по лабораторной работе №2

## Предметная область: Студенты

### Описание предметной области

В рамках лабораторной работы была реализована **файловая однотабличная база данных**, представляющая **информацию о студентах**.  
Каждая запись содержит следующие поля:

| Поле | Тип данных | Уникальность | Назначение |
|------|------------|--------------|------------|
| `Id` | `int` | Уникальное | Ключевое поле, идентификатор студента |
| `Name` | `string` | Не уникальное | Имя студента |
| `Gpa` | `float64` | Не уникальное | Средний балл студента |
| `Active` | `bool` | Не уникальное | Статус активности (обучается студент или нет) |

### Структура БД

- **Формат хранения**: JSONL (один JSON-объект на строку)
- **Индексы**:
  - `IdIndex map[int]int64` — `id` → `offset` (для быстрого поиска по ключу)
  - `NameIndex map[string]map[int]bool` — `name` → `id`
  - `GpaIndex map[float64]map[int]bool` — `gpa` → `id`
  - `ActiveIndex map[bool]map[int]bool` — `active` → `id`
  - `RecordInfo map[int]RecordInfo` — `id` → `(name, gpa, active)` (обратный индекс)

---

## Анализ сложности-эффективности алгоритмов

### 1. Добавление записи в БД

- **Операция**: `AddNewRecord`
- **Сложность**: `O(1)`
- **Описание**: 
  - Запись добавляется в конец файла (O(1))
  - Обновляются все индексы (O(1) для каждого)
  - Обновляется `RecordInfo` (O(1))

### 2. Удаление записи из БД

- **Операция**: `DeleteRecordById`
- **Сложность**: `O(1)`
- **Описание**:
  - Удаляется из `IdIndex`
  - Через `RecordInfo` находятся соответствующие `name`, `gpa`, `active`
  - Удаляется из всех индексов (`NameIndex`, `GpaIndex`, `ActiveIndex`) — O(1) благодаря `map[int]bool`
  - Удаляется из `RecordInfo`

- **Операция**: `DeleteRecordByName`, `DeleteRecordByGpa`, `DeleteRecordByActive`
- **Сложность**: `O(k)`, где `k` — количество записей с этим значением
- **Описание**:
  - Находятся все `id` по значению (O(1))
  - Для каждого `id` вызывается `DeleteRecordById` (O(1))

### 3. Поиск по БД

- **Операция**: `FindById`
- **Сложность**: `O(1)`
- **Описание**:
  - Поиск по `IdIndex` (O(1))
  - Чтение строки из файла по `offset` (O(1))

- **Операция**: `FindByName`, `FindByGpa`, `FindByActive`
- **Сложность**: `O(1)` на получение `id`, `O(k)` на чтение записей
- **Описание**:
  - Поиск по индексу (O(1))
  - Чтение `k` записей из файла (O(k))

---

## Особенности реализации

- **Мягкое удаление**: записи удаляются только из индексов, но остаются в файле
- **Бэкап**: копирует только **не удалённые** записи
- **Индексы**: позволяют ускорить поиск и удаление
- **Обратный индекс**: позволяет быстро удалять по `id` из всех индексов
- **Импорт таблицы базы данных из xlsx-файла**: реализован данный функционал 

---

## Вывод

Реализованная база данных обеспечивает **высокую эффективность** для операций с **ключевым полем** (`Id`) за счёт использования **индексов**.  
Для **не ключевых полей** сложность по-прежнему **оптимизирована** за счёт **хеш-таблиц** (`map`), что позволяет **достигнуть логарифмической или константной сложности** для большинства операций